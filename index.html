<script>
const GEMINI_API_KEY = "AIzaSyBR85_e6xk8is7aQCY5ckeArtjO9_BT9Kw";

async function sendMessage() {
    const input = document.getElementById("user-input");
    const message = input.value.trim();
    if (!message) return;
    appendMessage("user", message);
    input.value = "";

    // 🌐 Add context
    const context = `
You are Bougainvillea House Assistant, a virtual guide for visitors.
Refer to the website https://www.bougainvilleahouse.in/ for accurate info
about rooms, amenities, WiFi, kitchen, food, parking, and other services.
Always give friendly, short answers related to that property only.
If asked something irrelevant, politely say you can only answer about Bougainvillea House.
    `;

    try {
        const response = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=" + GEMINI_API_KEY, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                contents: [
                    { role: "user", parts: [{ text: context + "\n\nUser: " + message }] }
                ]
            })
        });

        const data = await response.json();
        const reply = data?.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, I couldn't find an answer.";
        appendMessage("bot", reply);
    } catch (error) {
        console.error(error);
        appendMessage("bot", "Error connecting to Gemini API.");
    }
}

function appendMessage(sender, text) {
    const chatBox = document.getElementById("chat-box");
    const messageDiv = document.createElement("div");
    messageDiv.className = sender === "user" ? "user-message" : "bot-message";
    messageDiv.innerText = text;
    chatBox.appendChild(messageDiv);
    chatBox.scrollTop = chatBox.scrollHeight;
}

document.getElementById("send-btn").addEventListener("click", sendMessage);
document.getElementById("user-input").addEventListener("keydown", (e) => {
    if (e.key === "Enter") sendMessage();
});
</script>
